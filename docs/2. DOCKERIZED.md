# Criando um container com o Docker

O Docker √© uma plataforma de c√≥digo aberto que facilita a cria√ß√£o, o gerenciamento e a execu√ß√£o de containers. Ele permite que voc√™ empacote uma aplica√ß√£o e suas depend√™ncias em um container, garantindo que ela funcione em qualquer ambiente.

Para garantir que o nosso container seja seguro, escal√°vel e dispon√≠vel, seguimos boas pr√°ticas de seguran√ßa, escalabilidade, disponibilidade, automa√ß√£o e entrega cont√≠nua.

Reduzimos o tamanho da imagem com o `multi-stage build`, utilizamos imagens oficiais com garantia de proced√™ncia, como imagem base a `cgr.dev/chainguard/python*`, uma imagem min√≠ma do Python. Afinal, quanto menor a imagem, menor a superf√≠cie de ataque.

Para atestar a qualidade do nosso `Dockerfile`, utilizamos o `hadolint`, um linter para Dockerfiles que verifica se o arquivo est√° seguindo as melhores pr√°ticas.

Para garantir que o container seja seguro, utilizamos o `docker scout`, uma ferramenta de seguran√ßa que verifica se a imagem possui vulnerabilidades conhecidas.

E para ter outra verifica√ß√£o de seguran√ßa, utilizamos o `trivy`, uma ferramenta de an√°lise de vulnerabilidades para imagens de cont√™ineres.

Para instalar a ferramenta `trivy`, execute o comando:

```bash
cd scripts
sudo chmod +x tools.sh
./tools.sh
```

Verificando a qualidade do Dockerfile com o `hadolint`:

```bash
cd src
hadolint Dockerfile
```

O output √© algo parecido com:

```bash
Dockerfile:4 DL3042 warning: Avoid use of cache directory with pip. Use `pip install --no-cache-dir <package>`
Dockerfile:6 DL3007 warning: Using latest is prone to errors if the image will ever update. Pin the version explicitly to a release tag
```

A partir dessas informa√ß√µes √© poss√≠vel corrigir o Dockerfile para seguir as melhores pr√°ticas.

Agora vamos construir a imagem Docker. Para isso, execute o comando:

```bash
cd src
docker build -t nataliagranato/giropops-senhas:v1.0.0 .
```

Para disponibilizar a imagem no Docker Hub, execute o comando:

```bash
docker push nataliagranato/giropops-senhas:v1.0.0
```

Para verificar se a imagem foi disponibilizada com sucesso, acesse o [Docker Hub](https://hub.docker.com/).

Verificando se a imagem possui vulnerabilidades conhecidas com o `trivy`:

```bash
trivy image nataliagranato/giropops-senhas:v1.0.0
```

Verificando se a imagem possui vulnerabilidades conhecidas com o `docker scout`:

```bash
docker-scout nataliagranato/giropops-senhas:v1.0.0
```

O resultado das an√°lises est√° dispon√≠vel em  `/screenshots`.

Se voc√™ chegou at√© aqui √© sabido que a aplica√ß√£o depende do Redis, por isso resolvemos construir uma imagem para ele at√© o momento sem vulnerabilidades conhecidas.

Para construir a imagem do Redis, execute o comando:

```bash
cd redis
docker build -t nataliagranato/giropops-redis:v1.0.0 .
```

Para disponibilizar a imagem no Docker Hub, execute o comando:

```bash
docker push nataliagranato/giropops-redis:v1.0.0
```

Agora que voc√™ sabe como verificar a qualidade e a seguran√ßa de uma imagem Docker, pode aplicar essas pr√°ticas em seus projetos. E n√£o esque√ßa de utilizar o `.dockerignore` para evitar a inclus√£o de arquivos desnecess√°rios na imagem.

Constru√≠ uma pipeline de CI/CD para automatizar a constru√ß√£o e a disponibiliza√ß√£o das imagens Docker. Para isso, utilizei o GitHub Actions, uma ferramenta de integra√ß√£o cont√≠nua e entrega cont√≠nua que permite automatizar tarefas e fluxos de trabalho. O arquivo de configura√ß√£o da pipeline est√° dispon√≠vel em `.github/workflows/giropops-docker.yml`. Clique [aqui](https://github.com/nataliagranato/LINUXtips-PICK/actions/runs/10586886113/job/29336546493) para visualizar o resultado da execu√ß√£o da pipeline.

Para experimentar a aplica√ß√£o execute o docker-compose na raiz do projeto:

```bash
docker-compose up -d
```

Acesse a aplica√ß√£o em `http://localhost:5000/`.

Isso foi tudo! Obrigada por acompanhar o projeto at√© aqui. üöÄ
